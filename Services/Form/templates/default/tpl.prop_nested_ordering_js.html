<!-- BEGIN nested_ordering_init -->
<script language="JavaScript" type="text/javascript"> var updateOutput__{INSTANCE_ID};
(function($) { $(document).ready(function () {

    updateOutput__{INSTANCE_ID} = function (e)
    {
        var containerSelector = 'div#nestable__{INSTANCE_ID}';
        var items = [], indent = 0, selektor = containerSelector + ' ';

        $(containerSelector).find('input[type=hidden].hiddenIndentationInput').remove();
        
        do
        {
            var found = false;
            
            selektor += ' > ol > li';
            
            $(selektor).each(
                function(pos, item)
                {
                    var val = $(item).attr('data-id');
                    console.log(item, val, indent);

                    found = true;
                   
                    $(containerSelector).append(
                        '<input type="hidden" class="hiddenIndentationInput" name="{INDENTATION_POSTVAR}[' + val + ']" value="' + indent + '" />'
                    );
                }
            );
            
            indent++;
         }
        while(found);

        return;
        
        var list = e.length ? e : $(e.target),
        output = list.data('output');
        console.log(output);return;
        if( window.JSON )
        {
            output.val(window.JSON.stringify(list.nestable('serialize')));
        } 
    };
    
    // activate Nestable for list 
    $('#nestable__{INSTANCE_ID}').nestable({
        group:1,
        expandBtnHTML:'',
        collapseBtnHTML:''
    }).on('change', updateOutput__{INSTANCE_ID});
    
    // output initial serialized data
    updateOutput__{INSTANCE_ID}($('#nestable__{INSTANCE_ID}').data('output', $('#answers_ordering__{INSTANCE_ID}')));
    
}); })(jQuery);
</script>
<!-- END nested_ordering_init -->
